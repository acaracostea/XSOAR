category: Network Security
commonfields:
  id: FortiManager
  version: -1
configuration:
- display: Server URL
  name: url
  required: true
  type: 0
- display: Username
  name: credentials
  required: true
  type: 9
- defaultvalue: global
  display: The instance ADOM
  name: adom
  required: true
  type: 0
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 5.0.0
    itemVersion: 1.0.7
    packID: FortiManager
    packName: FortiManager
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: FortiManager is a single console central management system that manages
  Fortinet devices.
detaileddescription: |-
  ## FortiManager
  - FortiManager is a single console central management system that manages Fortinet Devices.
  - You can use FortiManger integration to:
    - View, create, update and delete Addresses, Address-Groups, Services, Service-Groups, Policies, and Policy-Packages found in FortiManger.



  ---
  [View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/forti-manager)
display: FortiManager
image: data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAAyCAYAAACXpx/YAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAkOSURBVHgB7VprbFxHFT4z14+E1OmmgVISqdm0NBVVShwRXo0QLvzhB2odhEJVkGzzg6dQ1l7bQiBkB4HaJvZ6XfH6gRQ7bQVSkGwjlRZBZUc0JVBaO6AmrUqbNaEtbWlsE0ic9d4ZvnMf2bu3e/cRx3aazCd9u3vnPXPmnDNz9hIZGBgYGBgYGBgYGBgYGBgYGBgYGKw4BHgY3EDV4xT4JfC1Z3Zu3U2kforf6zjjrK3+9Ymjz7/vLztv+wk6+Hqwktb60R1PnfjsoztumbyhvrbRSSN9Tmj9jZc23v7Q7kOHbK/oU+B7qDKcBY+Box4V+BHwIGhV2EYOvBdcC/48kP5hcBbsAr9SWVPEc/greAgc8dpmbAJ/T9VhDvwiuAVMVVHvDa5Xg484eCNVD65bd2znrVtypH5AnnAvBoLEahIiddOrz/0dj096yZvBG6po5oPg58kVwsNgLXizN85KwEJYA9aD7w+kS+97fSi9HG4F7wI7wR95abVVtsHgzbXaG1s1da8BV4Unr8ndfZWAy+kcybuo+kEXwzrpWoQni+Qpj1FgLWVrxAvxHfAxLz0XKBOcqzP2UBu5ImlR4HLnS+TXeOTNch/4J/DpIuWKjSOqjKKLmE9YwH2U322V4HWs66v4HgomKq3ZrPCKHyF30fMQ4gWndyXG8DUVzDqTs09E9PN98ABF45PkmmPGRo/c9xZ3GHQtuSbTxz3gn4u0w9ryMSqPl8A7S+Sztv8BbCBXkz5DbxfwPPg58Dkqj7e8cjd7zx8AH6f8mNlyvVik3r/DAv4P+A+qAq/Mz4xsoIbfBtNWWdLZTR86cvwRfD1SrN5GkRvQ847JuoC1DdlcRDdzZcYV3Ch1lN9Up7zv60Llq55nCFnwnyXyOe9ZcjceI+qMM1PlOPyy4fm8RRHthAX8BfB2Kg8+hPyOf2ysu+6HQup7g5nzOfUmvraWauBNYY2+t77mtmDa3DnBB77dRYq3gh+PaIp95JbA8wJV7maWEsExyCL5vBHZfL8RUf/L4P9okQgLeCuVEYwHFoQjYC0UnL+4PpipRUl/6QAFYlDzgnowpg0Rxbd5rARsil+myx8s9KYS+Xz7WLSAJV15GABPk4GDsAYPkXtvK4f8YUiIZ5Wmhwqz9Uy5Bq6xrMdR728FiUpPRhT/GeVPxmHwCfrT4De956+CvwHP0eUN9uN84p+OyD9DlwBhAfPp8NdUDeZnDsKy/qogbfW8438mm+Ix+0xdqI8zZ3c889rZNQ3Z+2mmpuCQNfff01FXjxfKjOsVygv4FnIDJIs5RC0H2I3xSf8oXXoIj6rSIEAk9Op13ZZyIi351u138SHrDju7Jinr9T0F5cW6JxD8+trMXO3B9fVWwSHr+vp3j+NkX2m0qBTeCa6H154Ppx8tU45vJL+k6MNYGKvIverx1fDEogWMlZzGoaog0KGVc/eDpPV6HQqCIFTp3IOzWt2ohZXPQ7yylsQwXT3gtf9WBeX46shXrkoFfBO51yi+iy8seqeft2kMxuAJWiSEoBetOv0wGVwKcASNY/kbeBf9GIx5GUeoStzxx+Onpz61rWXh/ML3hBu1gVa7kSyt9FGSYm2wvCUs/lOAaoV4THtRHKER9pPiwe0Tz2cCRR8kunBterrMMDiadp/3myM7c6H8c4F8xkmKxsuhsv5hbYLy4dJKtOkX5IYoGX7UbCbUdiXg88ypUNrrgXbmvWcfx8l1URzsOUQGBgYGBgYGBtUgkehs6ujoaiWDklj0PbgcOjo6E4LknmCarfSudHr/VHXtdLVKpTN96b4JfrYk2hTO2yhDicS345ZU4ziVD6ZS+9J+nWSye1JrMZVKPdBGVymWIeIj+QqGf470Xp8QzyxVCdyTW5SUTf5zf2rfLtvOBv90j+Oa1uM/dELDETxpFFrF6SrGkmuwh9lUav9QMCGRSMQsWcdvaTSDGWjfELRvL+clO7pHINEJhL0SYAa/ZyGsJgiwEXktEO7mZLIrrbXkcJyvnbxpZtl0p6HlWlotJNSE/yKL059VO4JYKb/oFxMk0n2pB9oL+iPd6myKQF5HR3cP+k2QGyvI2Cq7PZ1Oo59EHO0dQHtNft+aFCxIXzrZ3gXrInrJ/Uu0NzCvk2xleCN61qaXlhjLFbONYaF6Xbp+05L1A5hkI8zudtZqTLqXheOUFjoGwaZJ2e22ttpg0nmBMlj8MaGUK1AlYiHthNBo2BKi2X3UzaRlxs9koSBMOsYCQn9tYCLYH/ISwlbtaIOtTCKZ/O4mr51p9LkLY9jOfUhZl3DHXzeglZzDZhMY6zBvRKVyQzw/LUQC87rTVnKzcPaW1w+sjIQlwrzalMqmaRmwXBocE0I7r68ILa51k3QTPob3u754qjPZvUey1rkRI6yXGEul+0f9BrD7+UWCTP+A64OLQWhrXAt7NJlMTmglDiNhWrhvjTqAAEYhoBaY+0bWbClFPFB7gv07/HkG/rzHts/zW53TSi2MkqxplRdeOBCbLtQQTmSK4+sZIcQ23kQY593Om4tSNEs38DUrpWz056W0HgzOa6mxXALO9PfvL/WSGv/XMOv+w+XBW7xqAB+dQWx+SpDVo4UaRCNxPy+R6Gq0pJhkDc3Z2XZoYHO59jw3MsnCF8oeRpy1UXsmX0g1CA0ehzmOQ9KNGG9bYDLT2FwZ9yftVcqaoBXCSv6tNgVzdTf7Ml5815epw6UqiID2REHbegxCiId9PrTV8fV9jt+riVNl4HJxW6nBHOUyaNeP2ZNtoz1oo60X4EKym/v79zlaiY06Bs3eBs2f4DEoRVPp9P0ZWiGsmIDhn9oVFgwacpI1ixcrLJQg+ADDhyCYQHaesahyinJD8JdvsxZK6VFWPtSfsSzBp+1KTvJ8+Mvw+GDax6GpGT/D4oOfEHsw/nHWcriYyS5sVGcO8Mk8L+4LG2uk1HiXGoJWGKzB+Jpl/1VBWWehKilbon4M9TNV1ouH67BAseuGcyoLza2N1VjigArcuS+2r0uNFRfwOxVJV8AZNt9S8tVK9rAf9k315YIr8a3KZYFty10w38dggvnkT3yVutyEa2BgYGBgYGBgYGBgYGBgYHBF4f9NGlwHsyreVgAAAABJRU5ErkJggg==
name: FortiManager
script:
  commands:
  - arguments:
    - description: The FortiManager Administrative Domain (ADOM) from which to fetch
        the devices. Leave empty to use the instance ADOM.
      name: adom
    - description: The name of a specific device to get. If not specified, will get
        all devices.
      name: device
    - defaultValue: "0"
      description: From which index to start the list. Default is 0.
      name: offset
    - defaultValue: "50"
      description: Until which index to get the list. Default is 50.
      name: limit
    description: List all devices in the ADOM instance.
    name: fortimanager-devices-list
    outputs:
    - contextPath: FortiManager.Device.adm_pass
      description: The ADOM password.
      type: String
    - contextPath: FortiManager.Device.adm_usr
      description: The ADOM user.
      type: String
    - contextPath: FortiManager.Device.app_ver
      description: The app version of the device.
      type: String
    - contextPath: FortiManager.Device.av_ver
      description: The antivirus version of the device.
      type: String
    - contextPath: FortiManager.Device.beta
      description: The beta version of the device.
      type: Number
    - contextPath: FortiManager.Device.branch_pt
      description: The branch point of the device.
      type: Number
    - contextPath: FortiManager.Device.build
      description: The build of the device.
      type: Number
    - contextPath: FortiManager.Device.checksum
      description: The checksum of the device.
      type: String
    - contextPath: FortiManager.Device.conf_status
      description: The configuration status of the device.
      type: String
    - contextPath: FortiManager.Device.conn_mode
      description: The connection mode of the device.
      type: String
    - contextPath: FortiManager.Device.conn_status
      description: The connection status of the device.
      type: String
    - contextPath: FortiManager.Device.db_status
      description: The database status of the device.
      type: String
    - contextPath: FortiManager.Device.desc
      description: The description of the device.
      type: String
    - contextPath: FortiManager.Device.dev_status
      description: The status of the device.
      type: String
    - contextPath: FortiManager.Device.fap_cnt
      description: The FortiManager access point count.
      type: Number
    - contextPath: FortiManager.Device.faz.full_act
      description: Full act.
      type: Number
    - contextPath: FortiManager.Device.faz.perm
      description: Perm.
      type: Number
    - contextPath: FortiManager.Device.faz.quota
      description: Quota.
      type: Number
    - contextPath: FortiManager.Device.faz.used
      description: Used.
      type: Number
    - contextPath: FortiManager.Device.fex_cnt
      description: Fex count.
      type: Number
    - contextPath: FortiManager.Device.flags
      description: Flags.
      type: String
    - contextPath: FortiManager.Device.foslic_cpu
      description: Foslic CPU.
      type: Number
    - contextPath: FortiManager.Device.foslic_dr_site
      description: Foslic dr site.
      type: String
    - contextPath: FortiManager.Device.foslic_inst_time
      description: Foslic inst time.
      type: Number
    - contextPath: FortiManager.Device.foslic_last_sync
      description: Foslic last sync.
      type: Number
    - contextPath: FortiManager.Device.foslic_ram
      description: Foslic RAM.
      type: Number
    - contextPath: FortiManager.Device.foslic_type
      description: Foslic type.
      type: String
    - contextPath: FortiManager.Device.foslic_utm
      description: Foslic UTM.
      type: String
    - contextPath: FortiManager.Device.fsw_cnt
      description: FSW count.
      type: Number
    - contextPath: FortiManager.Device.ha_group_id
      description: HA group ID.
      type: Number
    - contextPath: FortiManager.Device.ha_group_name
      description: HA group name.
      type: String
    - contextPath: FortiManager.Device.ha_mode
      description: HA mode.
      type: String
    - contextPath: FortiManager.Device.hdisk_size
      description: Hard disk size.
      type: Number
    - contextPath: FortiManager.Device.hostname
      description: Hostname.
      type: String
    - contextPath: FortiManager.Device.hw_rev_major
      description: Hardware major revision number.
      type: Number
    - contextPath: FortiManager.Device.hw_rev_minor
      description: Hardware minor revision number.
      type: Number
    - contextPath: FortiManager.Device.ip
      description: Device IP.
      type: String
    - contextPath: FortiManager.Device.ips_ext
      description: External IP.
      type: Number
    - contextPath: FortiManager.Device.ips_ver
      description: IP version.
      type: String
    - contextPath: FortiManager.Device.last_checked
      description: Last checked.
      type: Number
    - contextPath: FortiManager.Device.last_resync
      description: Last resync.
      type: Number
    - contextPath: FortiManager.Device.latitude
      description: Latitude.
      type: String
    - contextPath: FortiManager.Device.lic_flags
      description: License flags.
      type: Number
    - contextPath: FortiManager.Device.lic_region
      description: License region.
      type: String
    - contextPath: FortiManager.Device.location_from
      description: Location from.
      type: String
    - contextPath: FortiManager.Device.logdisk_size
      description: Log disk size.
      type: Number
    - contextPath: FortiManager.Device.longitude
      description: Longitude.
      type: String
    - contextPath: FortiManager.Device.maxvdom
      description: Maximum VDOM.
      type: Number
    - contextPath: FortiManager.Device.meta_fields
      description: Meta fields.
      type: String
    - contextPath: FortiManager.Device.mgmt_id
      description: Management ID.
      type: Number
    - contextPath: FortiManager.Device.mgmt_if
      description: Management IF.
      type: String
    - contextPath: FortiManager.Device.mgmt_mode
      description: Management mode.
      type: String
    - contextPath: FortiManager.Device.mgt_vdom
      description: Management VDOM.
      type: String
    - contextPath: FortiManager.Device.module_sn
      description: Module serial number.
      type: String
    - contextPath: FortiManager.Device.mr
      description: Mr.
      type: Number
    - contextPath: FortiManager.Device.name
      description: Device name.
      type: String
    - contextPath: FortiManager.Device.os_type
      description: Device operating system type.
      type: String
    - contextPath: FortiManager.Device.os_ver
      description: Device operating system version.
      type: String
    - contextPath: FortiManager.Device.patch
      description: Patch.
      type: Number
    - contextPath: FortiManager.Device.platform_str
      description: Platform string.
      type: String
    - contextPath: FortiManager.Device.prefer_img_ver
      description: Prefer image version.
      type: String
    - contextPath: FortiManager.Device.prio
      description: Prio.
      type: Number
    - contextPath: FortiManager.Device.psk
      description: PSK.
      type: String
    - contextPath: FortiManager.Device.role
      description: Device role.
      type: String
    - contextPath: FortiManager.Device.sn
      description: Serial number.
      type: String
    - contextPath: FortiManager.Device.vdom.comments
      description: VDOM comments.
      type: String
    - contextPath: FortiManager.Device.vdom.name
      description: VDOM name.
      type: String
    - contextPath: FortiManager.Device.vdom.opmode
      description: VDOM opmode.
      type: String
    - contextPath: FortiManager.Device.vdom.rtm_prof_id
      description: VDOM rtm prof ID.
      type: Number
    - contextPath: FortiManager.Device.vdom.status
      description: VDOM status.
      type: String
    - contextPath: FortiManager.Device.vdom.vpn_id
      description: VDOM VPN ID.
      type: Number
    - contextPath: FortiManager.Device.version
      description: Device version.
      type: Number
    - contextPath: FortiManager.Device.vm_cpu
      description: VM CPU.
      type: Number
    - contextPath: FortiManager.Device.vm_cpu_limit
      description: VM CPU limit.
      type: Number
    - contextPath: FortiManager.Device.vm_lic_expire
      description: VM license expiration.
      type: Number
    - contextPath: FortiManager.Device.vm_mem
      description: VM memory.
      type: Number
    - contextPath: FortiManager.Device.vm_mem_limit
      description: VM memory limit.
      type: Number
    - contextPath: FortiManager.Device.vm_status
      description: VM status.
      type: Number
  - arguments:
    - description: The ADOM from which to fetch the device groups. Leave empty to
        use the instance ADOM.
      name: adom
    - description: The name of a device group to fetch.  If not specified, will get
        all device groups.
      name: group
    - defaultValue: "0"
      description: From which index to start the list. Default is 0.
      name: offset
    - defaultValue: "50"
      description: Until which index to get the list. Default is 50.
      name: limit
    description: List ADOM device groups.
    name: fortimanager-device-groups-list
    outputs:
    - contextPath: FortiManager.DeviceGroup.desc
      description: Description.
      type: String
    - contextPath: FortiManager.DeviceGroup.meta_fields
      description: Device group meta fields.
      type: String
    - contextPath: FortiManager.DeviceGroup.name
      description: Device group name.
      type: String
    - contextPath: FortiManager.DeviceGroup.os_type
      description: Device group operating system type.
      type: String
    - contextPath: FortiManager.DeviceGroup.type
      description: Device group type.
      type: String
  - arguments:
    - description: The ADOM from which to fetch the addresses. Leave empty to use
        the instance ADOM.
      name: adom
    - defaultValue: "0"
      description: From which index to start the list. Default is 0.
      name: offset
    - defaultValue: "50"
      description: To which index to get the list. Default is 50.
      name: limit
    - description: The name of a specific address to fetch.  If not specified, will
        get all addresses.
      name: address
    description: List ADOM firewall IPv4 addresses.
    name: fortimanager-address-list
    outputs:
    - contextPath: FortiManager.Address._image-base64
      description: Base64 of the address image.
      type: String
    - contextPath: FortiManager.Address.allow-routing
      description: Enable/disable use of this address in the static route configuration.
      type: String
    - contextPath: FortiManager.Address.associated-interface
      description: Network interface associated with address.
      type: String
    - contextPath: FortiManager.Address.cache-ttl
      description: Defines the minimal TTL of individual IP addresses in FQDN cache
        measured in seconds.
      type: Number
    - contextPath: FortiManager.Address.color
      description: The color of the icon in the GUI.
      type: Number
    - contextPath: FortiManager.Address.comment
      description: The comments attached to the address.
      type: String
    - contextPath: FortiManager.Address.country
      description: The IP addresses associated with a specific country.
      type: String
    - contextPath: FortiManager.Address.dynamic_mapping
      description: The address dynamic mapping information.
      type: String
    - contextPath: FortiManager.Address.end-ip
      description: The final IP address (inclusive) in the range for the address.
      type: String
    - contextPath: FortiManager.Address.epg-name
      description: The endpoint group name.
      type: String
    - contextPath: FortiManager.Address.filter
      description: The match criteria filter.
      type: String
    - contextPath: FortiManager.Address.fqdn
      description: The fully qualified domain name (fqdn) address.
      type: String
    - contextPath: FortiManager.Address.list.ip
      description: The IP list associated with the address.
      type: String
    - contextPath: FortiManager.Address.name
      description: The address name.
      type: String
    - contextPath: FortiManager.Address.obj-id
      description: The object ID for NSX.
      type: String
    - contextPath: FortiManager.Address.organization
      description: 'The organization domain name (Syntax: organization/domain).'
      type: String
    - contextPath: FortiManager.Address.policy-group
      description: The policy group name.
      type: String
    - contextPath: FortiManager.Address.sdn
      description: The software defined networking (SDN).
      type: String
    - contextPath: FortiManager.Address.sdn-tag
      description: The software defined networking (SDN) tag.
      type: String
    - contextPath: FortiManager.Address.start-ip
      description: The first IP address (inclusive) in the range for the address.
      type: String
    - contextPath: FortiManager.Address.subnet
      description: The IP address and subnet mask of address.
      type: String
    - contextPath: FortiManager.Address.subnet-name
      description: The subnet name.
      type: String
    - contextPath: FortiManager.Address.tagging.category
      description: The tag category.
      type: String
    - contextPath: FortiManager.Address.tagging.name
      description: The tagging entry name.
      type: String
    - contextPath: FortiManager.Address.tagging.tags
      description: The tags.
      type: String
    - contextPath: FortiManager.Address.tenant
      description: The tenant.
      type: String
    - contextPath: FortiManager.Address.type
      description: The type of address.
      type: String
    - contextPath: FortiManager.Address.uuid
      description: Universally Unique Identifier (UUID). This is automatically assigned
        but can be manually reset.
      type: String
    - contextPath: FortiManager.Address.visibility
      description: Enable/disable address visibility in the GUI.
      type: String
    - contextPath: FortiManager.Address.wildcard
      description: The IP address and wildcard netmask.
      type: String
    - contextPath: FortiManager.Address.wildcard-fqdn
      description: The fully qualified domain name (fqdn) with wildcard characters.
      type: String
  - arguments:
    - description: The ADOM on which to create the address. Leave empty to use the
        instance ADOM.
      name: adom
    - description: The address name.
      name: name
      required: true
    - auto: PREDEFINED
      description: 'The type of address. Possible values are: "ipmask", "iprange",
        "fqdn", "wildcard", "geography", "wildcard-fqdn", and "dynamic".'
      name: type
      predefined:
      - ipmask
      - iprange
      - fqdn
      - wildcard
      - geography
      - wildcard-fqdn
      - dynamic
      required: true
    - description: Policy group name.
      name: policy_group
    - description: A comment to add to the address.
      name: comment
    - description: The network interface associated with the address.
      name: associated_interface
    - description: The fully qualified domain name (fqdn) address. Required for fqdn
        address type.
      name: fqdn
    - description: First IP address (inclusive) in the range for the address. Required
        for iprange address type.
      name: start_ip
    - description: Final IP address (inclusive) in the range for the address. Required
        for iprange address type.
      name: end_ip
    - description: IP address and subnet mask of address. Required for ipmask address
        type.
      name: subnet
    - description: The subnet name
      name: subnet_name
    - auto: PREDEFINED
      description: 'The address SDN. Required for dynamic address type. Possible values
        are: "aci", "aws", "nsx", "nuage", and "azure".'
      name: sdn
      predefined:
      - aci
      - aws
      - nsx
      - nuage
      - azure
    - description: IP address and wildcard netmask. Required for wildcard address
        type.
      name: wildcard
    - description: The fully qualified domain name (fqdn) with wildcard characters.
        Required for wildcard-fqdn address type.
      name: wildcard_fqdn
    - description: 'The two letter abbreviation representing a country associated
        with an IP address (for example: "us"). Required for geography address type. '
      name: country
    description: Add a new IPv4 address.
    name: fortimanager-address-create
  - arguments:
    - description: The ADOM on which to update the address. Leave empty to use the
        instance ADOM.
      name: adom
    - description: The address name.
      name: name
      required: true
    - auto: PREDEFINED
      description: 'Type of address. Possible values are: "ipmask", "iprange", "fqdn",
        "wildcard", "geography", "wildcard-fqdn", and "dynamic".'
      name: type
      predefined:
      - ipmask
      - iprange
      - fqdn
      - wildcard
      - geography
      - wildcard-fqdn
      - dynamic
    - description: Policy group name.
      name: policy_group
    - description: A comment to add to the address.
      name: comment
    - description: Network interface associated with address.
      name: associated_interface
    - description: The fully qualified domain name (fqdn) address. Required for fqdn
        address type.
      name: fqdn
    - description: First IP address (inclusive) in the range for the address. Required
        for iprange address type.
      name: start_ip
    - description: Final IP address (inclusive) in the range for the address. Required
        for iprange address type.
      name: end_ip
    - description: IP address and subnet mask of address. Required for ipmask address
        type.
      name: subnet
    - description: The subnet name
      name: subnet_name
    - auto: PREDEFINED
      description: 'The address SDN. Required for dynamic address type. Possible values
        are: "aci", "aws", "nsx", "nuage", and "azure".'
      name: sdn
      predefined:
      - aci
      - aws
      - nsx
      - nuage
      - azure
    - description: IP address and wildcard netmask. Required for wildcard address
        type.
      name: wildcard
    - description: The fully qualified domain name (fqdn) with wildcard characters.
        Required for wildcard-fqdn address type.
      name: wildcard_fqdn
    - description: 'The two letter abbreviation representing a country associated
        with an IP address (for example: "us"). Required for geography address type. '
      name: country
    description: Add a new IPv4 address.
    name: fortimanager-address-update
  - arguments:
    - description: The ADOM from which to delete the address. Leave empty to use the
        default integration ADOM.
      name: adom
    - description: The address to delete.
      name: address
      required: true
    description: Delete an address.
    name: fortimanager-address-delete
  - arguments:
    - description: The ADOM from which to fetch the address groups. Leave empty to
        use the instance ADOM.
      name: adom
    - defaultValue: "0"
      description: From which index to start the list. Default is 0.
      name: offset
    - defaultValue: "50"
      description: To which index to get the list. Default is 50.
      name: limit
    - description: Name for a specific address group to fetch. If not specified, will
        get all address groups.
      name: address_group
    description: List ADOM IPv4 address groups.
    name: fortimanager-address-group-list
    outputs:
    - contextPath: FortiManager.AddressGroup._image-base64
      description: Base64 of the address group image.
      type: String
    - contextPath: FortiManager.AddressGroup.allow-routing
      description: Enable/disable use of this group in the static route configuration.
      type: String
    - contextPath: FortiManager.AddressGroup.color
      description: The color of the icon in the GUI.
      type: Number
    - contextPath: FortiManager.AddressGroup.comment
      description: The comment about the address group.
      type: String
    - contextPath: FortiManager.AddressGroup.dynamic_mapping._image-base64
      description: The address group dynamic mapping base64 image.
      type: String
    - contextPath: FortiManager.AddressGroup.dynamic_mapping._scope.name
      description: The address group dynamic mapping scope name.
      type: String
    - contextPath: FortiManager.AddressGroup.dynamic_mapping._scope.vdom
      description: The address group dynamic mapping scope VDOM.
      type: String
    - contextPath: FortiManager.AddressGroup.dynamic_mapping.allow-routing
      description: Enable/disable use of this dynamic mapping in the static route
        configuration.
      type: String
    - contextPath: FortiManager.AddressGroup.dynamic_mapping.color
      description: The color of the icon in the GUI.
      type: Number
    - contextPath: FortiManager.AddressGroup.dynamic_mapping.comment
      description: The comment about the address group dynamic mapping.
      type: String
    - contextPath: FortiManager.AddressGroup.dynamic_mapping.exclude
      description: Whether to enable or disable the exclusion of the dynamic mapping.
      type: String
    - contextPath: FortiManager.AddressGroup.dynamic_mapping.exclude-member
      description: The exclude member.
      type: String
    - contextPath: FortiManager.AddressGroup.dynamic_mapping.global-object
      description: The global object.
      type: Number
    - contextPath: FortiManager.AddressGroup.dynamic_mapping.member
      description: The address group dynamic mapping member.
      type: String
    - contextPath: FortiManager.AddressGroup.dynamic_mapping.tags
      description: The address group dynamic mapping tags.
      type: String
    - contextPath: FortiManager.AddressGroup.dynamic_mapping.type
      description: The address group dynamic mapping type.
      type: String
    - contextPath: FortiManager.AddressGroup.dynamic_mapping.uuid
      description: The address group dynamic mapping UUID.
      type: String
    - contextPath: FortiManager.AddressGroup.dynamic_mapping.visibility
      description: The address group dynamic mapping visibility.
      type: String
    - contextPath: FortiManager.AddressGroup.member
      description: The address objects contained within the group.
      type: String
    - contextPath: FortiManager.AddressGroup.name
      description: The address group name.
      type: String
    - contextPath: FortiManager.AddressGroup.tagging.category
      description: The tag category.
      type: String
    - contextPath: FortiManager.AddressGroup.tagging.name
      description: The tagging entry name.
      type: String
    - contextPath: FortiManager.AddressGroup.tagging.tags
      description: The tags.
      type: String
    - contextPath: FortiManager.AddressGroup.uuid
      description: Universally Unique Identifier (UUID). This is automatically assigned
        but can be manually reset.
      type: String
    - contextPath: FortiManager.AddressGroup.visibility
      description: Enable/disable address visibility in the GUI.
      type: String
  - arguments:
    - description: The ADOM on which to create the address group. Leave empty to use
        the instance ADOM.
      name: adom
    - description: Address group name.
      name: name
      required: true
    - description: A comma-separated list of the address or address group objects
        contained within the group.
      name: member
      required: true
    - description: A comment about the address group.
      name: comment
    description: Create a new address group.
    name: fortimanager-address-group-create
  - arguments:
    - description: The ADOM on which to update the address group. Leave empty to use
        the instance ADOM.
      name: adom
    - description: Address group name.
      name: name
      required: true
    - description: A comma-separated list of the address or address group objects
        contained within the group.
      name: member
    - description: A comment about the address group.
      name: comment
    description: Create a new address group.
    name: fortimanager-address-group-update
  - arguments:
    - description: The ADOM from which to delete the address group. Leave empty to
        use the default integration ADOM.
      name: adom
    - description: The address group to delete.
      name: address_group
      required: true
    description: Delete an address group.
    name: fortimanager-address-group-delete
  - arguments:
    - description: The ADOM from which to fetch the service categories. Leave empty
        to use the instance ADOM.
      name: adom
    - defaultValue: "0"
      description: From which index to start the list. Default is 0.
      name: offset
    - defaultValue: "50"
      description: To which index to get the list. Default is 50.
      name: limit
    - description: Name of a specific category to fetch. If not specified, will get
        all service groups.
      name: service_category
    description: List the ADOM service categories.
    name: fortimanager-service-categories-list
    outputs:
    - contextPath: FortiManager.ServiceCategory.comment
      description: Comment.
      type: String
    - contextPath: FortiManager.ServiceCategory.name
      description: Service category name.
      type: String
  - arguments:
    - description: The ADOM from which to fetch the service groups. Leave empty to
        use the instance ADOM.
      name: adom
    - defaultValue: "0"
      description: From which index to start the list. Default is 0.
      name: offset
    - defaultValue: "50"
      description: To which index to get the list. Default is 50.
      name: limit
    - description: Name of a specific service group to fetch. If not specified, will
        get all service groups.
      name: service_group
    description: List ADOM service groups.
    name: fortimanager-service-group-list
    outputs:
    - contextPath: FortiManager.ServiceGroup.color
      description: The color of the icon in the GUI.
      type: Number
    - contextPath: FortiManager.ServiceGroup.comment
      description: Comment.
      type: String
    - contextPath: FortiManager.ServiceGroup.member
      description: The service objects contained within the group.
      type: String
    - contextPath: FortiManager.ServiceGroup.name
      description: The address group name.
      type: String
    - contextPath: FortiManager.ServiceGroup.proxy
      description: Enable/disable web proxy service group.
      type: String
  - arguments:
    - description: The ADOM on which to create the service group. Leave empty to use
        the instance ADOM.
      name: adom
    - description: A comment.
      name: comment
    - description: The created service group name.
      name: name
      required: true
    - auto: PREDEFINED
      description: Enable/disable a web proxy service group.
      name: proxy
      predefined:
      - enable
      - disable
    - description: A comma-separated list of service objects to be contained within
        the group.
      name: member
      required: true
    description: Creates a new service group.
    name: fortimanager-service-group-create
  - arguments:
    - description: The ADOM on which to update the service group. Leave empty to use
        the instance ADOM.
      name: adom
    - description: A comment.
      name: comment
    - description: The created service group name.
      name: name
      required: true
    - auto: PREDEFINED
      description: Enable/disable a web proxy service group.
      name: proxy
      predefined:
      - enable
      - disable
    - description: A comma-sperated list of service objects to be contained within
        the group.
      name: member
    description: Create a new service group.
    name: fortimanager-service-group-update
  - arguments:
    - description: The ADOM from which to delete the service group. Leave empty to
        use the default integration ADOM.
      name: adom
    - description: The service group to delete.
      name: service_group
      required: true
    description: Delete a service group.
    name: fortimanager-service-group-delete
  - arguments:
    - description: The ADOM from which to fetch the custom service. Leave empty to
        use the instance ADOM.
      name: adom
    - defaultValue: "0"
      description: From which index to start the list. Default is 0.
      name: offset
    - defaultValue: "50"
      description: To which index to get the list. Default is 50.
      name: limit
    - description: Name of a specific custom service to fetch.  If not specified,
        will get all custom services.
      name: custom_service
    description: List the custom services.
    name: fortimanager-custom-service-list
    outputs:
    - contextPath: FortiManager.CustomService.app-category
      description: Application category ID.
      type: Number
    - contextPath: FortiManager.CustomService.app-service-type
      description: Application service type.
      type: String
    - contextPath: FortiManager.CustomService.application
      description: Application ID.
      type: Number
    - contextPath: FortiManager.CustomService.category
      description: Service category.
      type: String
    - contextPath: FortiManager.CustomService.check-reset-range
      description: Configure the type of ICMP error message verification.
      type: String
    - contextPath: FortiManager.CustomService.color
      description: Color of icon in the GUI.
      type: Number
    - contextPath: FortiManager.CustomService.comment
      description: Comment.
      type: String
    - contextPath: FortiManager.CustomService.fqdn
      description: Fully qualified domain (fqdn) name.
      type: String
    - contextPath: FortiManager.CustomService.helper
      description: Helper name.
      type: String
    - contextPath: FortiManager.CustomService.icmpcode
      description: ICMP code.
      type: Number
    - contextPath: FortiManager.CustomService.icmptype
      description: ICMP type.
      type: Number
    - contextPath: FortiManager.CustomService.iprange
      description: Start and end of the IP range associated with service.
      type: String
    - contextPath: FortiManager.CustomService.name
      description: Custom service name.
      type: String
    - contextPath: FortiManager.CustomService.protocol
      description: Protocol type based on IANA numbers.
      type: String
    - contextPath: FortiManager.CustomService.protocol-number
      description: IP protocol number.
      type: Number
    - contextPath: FortiManager.CustomService.proxy
      description: Enable/disable a web proxy service.
      type: String
    - contextPath: FortiManager.CustomService.sctp-portrange
      description: Multiple SCTP port ranges.
      type: String
    - contextPath: FortiManager.CustomService.session-ttl
      description: Session TTL (300 - 604800. Default is 0.).
      type: Number
    - contextPath: FortiManager.CustomService.tcp-halfclose-timer
      description: Wait time to close a TCP session waiting for an unanswered FIN
        packet (1 - 86400 sec. Default is 0.).
      type: Number
    - contextPath: FortiManager.CustomService.tcp-halfopen-timer
      description: Wait time to close a TCP session waiting for an unanswered open
        session packet (1 - 86400 sec. Default is 0.).
      type: Number
    - contextPath: FortiManager.CustomService.tcp-portrange
      description: Multiple TCP port ranges.
      type: String
    - contextPath: FortiManager.CustomService.tcp-timewait-timer
      description: Set the length of the TCP TIME-WAIT state in seconds (1 - 300 sec.
        Default is 0.).
      type: Number
    - contextPath: FortiManager.CustomService.udp-idle-timer
      description: UDP half close timeout (0 - 86400 sec. Default is 0.).
      type: Number
    - contextPath: FortiManager.CustomService.udp-portrange
      description: Multiple UDP port ranges.
      type: String
    - contextPath: FortiManager.CustomService.visibility
      description: Enable/disable the visibility of the service in the GUI.
      type: String
  - arguments:
    - description: The ADOM from which to fetch the custom service. Leave empty to
        use the instance ADOM.
      name: adom
    - description: The name of the new custom service.
      name: name
      required: true
    - description: Application category ID.
      name: app_category
    - auto: PREDEFINED
      defaultValue: disable
      description: 'Application service type. Possible values are: "app-id", "disable",
        and "app-category". Default is "disable".'
      name: app_service_type
      predefined:
      - app-id
      - disable
      - app-category
    - description: The application ID.
      name: application
    - description: The service category.
      name: category
    - auto: PREDEFINED
      description: 'Configure the type of ICMP error message verification. Possible
        values are: "disable", "default", and "strict".'
      name: check_reset_range
      predefined:
      - disable
      - default
      - strict
    - description: A comment.
      name: comment
    - description: Fully qualified domain name (fqdn).
      name: fqdn
    - auto: PREDEFINED
      description: Helper name.
      name: helper
      predefined:
      - disable
      - auto
      - ftp
      - tftp
      - ras
      - h323
      - tns
      - mms
      - sip
      - pptp
      - rtsp
      - dns-udp
      - dns-tcp
      - pmap
      - rsh
      - dcerpc
      - mgcp
      - gtp-c
      - gtp-u
      - gtp-b
    - description: ICMP code.
      name: icmpcode
    - description: ICMP type.
      name: icmptype
    - description: Start and end of the IP range associated with the service.
      name: iprange
    - auto: PREDEFINED
      description: 'Protocol type based on IANA numbers. Possible values are: "ICMP",
        "IP", "TCP/UDP/SCTP", "ICMP6", "HTTP", "FTP", "CONNECT", "SOCKS", "ALL", "SOCKS-TCP",
        and "SOCKS-UDP".'
      name: protocol
      predefined:
      - ICMP
      - IP
      - TCP/UDP/SCTP
      - ICMP6
      - HTTP
      - FTP
      - CONNECT
      - SOCKS
      - ALL
      - SOCKS-TCP
      - SOCKS-UDP
    - auto: PREDEFINED
      description: Enable/disable a web proxy service.
      name: proxy
      predefined:
      - enable
      - disable
    - description: Multiple SCTP port ranges.
      name: sctp_portrange
    - defaultValue: "0"
      description: Session TTL in the range of 300 - 604800. Default is 0.
      name: session_ttl
    - defaultValue: "0"
      description: Wait time to close a TCP session waiting for an unanswered FIN
        packet (1 - 86400 sec). Default is 0.
      name: tcp_halfclose_timer
    - defaultValue: "0"
      description: Wait time to close a TCP session waiting for an unanswered open
        session packet (1 - 86400 sec). Default is 0.
      name: tcp_halfopen_timer
    - description: Multiple TCP port ranges.
      name: tcp_portrange
    - defaultValue: "0"
      description: Set the length of the TCP TIME-WAIT state in seconds (1 - 300 sec).
        Default is 0.
      name: tcp_timewait_timer
    - defaultValue: "0"
      description: UDP half close timeout (0 - 86400 sec). Default is 0.
      name: udp_idle_timer
    - description: Multiple UDP port ranges.
      name: udp_portrange
    description: Create a new custom service.
    name: fortimanager-custom-service-create
  - arguments:
    - description: The ADOM in which to update the custom service. Leave empty to
        use the instance ADOM.
      name: adom
    - description: The name of the new custom service.
      name: name
      required: true
    - description: Application category ID.
      name: app_category
    - auto: PREDEFINED
      defaultValue: disable
      description: 'Application service type. Possible values are: "app-id", "disable",
        and "app-category". Default is "disable".'
      name: app_service_type
      predefined:
      - app-id
      - disable
      - app-category
    - description: The application ID.
      name: application
    - description: The service category.
      name: category
    - auto: PREDEFINED
      description: 'Configure the type of ICMP error message verification. Possible
        values are: "disable", "default", and "strict".'
      name: check_reset_range
      predefined:
      - disable
      - default
      - strict
    - description: A comment.
      name: comment
    - description: Fully qualified domain name (fqdn).
      name: fqdn
    - auto: PREDEFINED
      description: Helper name.
      name: helper
      predefined:
      - disable
      - auto
      - ftp
      - tftp
      - ras
      - h323
      - tns
      - mms
      - sip
      - pptp
      - rtsp
      - dns-udp
      - dns-tcp
      - pmap
      - rsh
      - dcerpc
      - mgcp
      - gtp-c
      - gtp-u
      - gtp-b
    - description: ICMP code.
      name: icmpcode
    - description: ICMP type.
      name: icmptype
    - description: Start and end of the IP range associated with service.
      name: iprange
    - auto: PREDEFINED
      description: 'Protocol type based on IANA numbers. Possible values are: "ICMP",
        "IP", "TCP/UDP/SCTP", "ICMP6", "HTTP", "FTP", "CONNECT", "SOCKS", "ALL", "SOCKS-TCP",
        and "SOCKS-UDP".'
      name: protocol
      predefined:
      - ICMP
      - IP
      - TCP/UDP/SCTP
      - ICMP6
      - HTTP
      - FTP
      - CONNECT
      - SOCKS
      - ALL
      - SOCKS-TCP
      - SOCKS-UDP
    - auto: PREDEFINED
      description: Enable/disable a web proxy service.
      name: proxy
      predefined:
      - enable
      - disable
    - description: Multiple SCTP port ranges.
      name: sctp_portrange
    - defaultValue: "0"
      description: Session TTL in the range of 300 - 604800. Default is 0.
      name: session_ttl
    - defaultValue: "0"
      description: Wait time to close a TCP session waiting for an unanswered FIN
        packet (1 - 86400 sec). Default is 0.
      name: tcp_halfclose_timer
    - defaultValue: "0"
      description: Wait time to close a TCP session waiting for an unanswered open
        session packet (1 - 86400 sec). Default is 0.
      name: tcp_halfopen_timer
    - description: Multiple TCP port ranges.
      name: tcp_portrange
    - defaultValue: "0"
      description: Set the length of the TCP TIME-WAIT state in seconds (1 - 300 sec).
        Default is 0.
      name: tcp_timewait_timer
    - defaultValue: "0"
      description: UDP half close timeout (0 - 86400 sec). Default is 0.
      name: udp_idle_timer
    - description: Multiple UDP port ranges.
      name: udp_portrange
    description: Update a custom service.
    name: fortimanager-custom-service-update
  - arguments:
    - description: The ADOM from which to delete the custom service. Leave empty to
        use the default integration ADOM.
      name: adom
    - description: The custome service to delete.
      name: custom
      required: true
    description: Delete a custom service.
    name: fortimanager-custom-service-delete
  - arguments:
    - description: The ADOM from which to fetch the firewall policy packages. Leave
        empty to use the instance ADOM.
      name: adom
    - defaultValue: "0"
      description: From which index to start the list. Default is 0.
      name: offset
    - defaultValue: "50"
      description: To which index to get the list. Default is 50.
      name: limit
    - description: Name of a specific policy package to fetch. If not specified, will
        get all policy packages.
      name: policy_package
    description: List ADOM policy packages.
    name: fortimanager-firewall-policy-package-list
    outputs:
    - contextPath: FortiManager.PolicyPackage.name
      description: Policy package name.
      type: String
    - contextPath: FortiManager.PolicyPackage.obj_ver
      description: Policy package object version.
      type: Number
    - contextPath: FortiManager.PolicyPackage.oid
      description: Policy package OID.
      type: Number
    - contextPath: FortiManager.PolicyPackage.package setting.central-nat
      description: Whether to use the central NAT.
      type: String
    - contextPath: FortiManager.PolicyPackage.package setting.consolidated-firewall-mode
      description: Whether to enable consolidate firewall mode.
      type: String
    - contextPath: FortiManager.PolicyPackage.package setting.fwpolicy-implicit-log
      description: Whether to enable firewall policy implicit log.
      type: String
    - contextPath: FortiManager.PolicyPackage.package setting.fwpolicy6-implicit-log
      description: Whether to enable firewall policy 6 implicit log.
      type: String
    - contextPath: FortiManager.PolicyPackage.package setting.inspection-mode
      description: Package inspection mode.
      type: String
    - contextPath: FortiManager.PolicyPackage.package setting.ngfw-mode
      description: Package NGFW mode.
      type: String
    - contextPath: FortiManager.PolicyPackage.package setting.ssl-ssh-profile
      description: Package SSL SSH profile.
      type: String
    - contextPath: FortiManager.PolicyPackage.scope_member.name
      description: Policy package scope member name.
      type: String
    - contextPath: FortiManager.PolicyPackage.scope_member.vdom
      description: Policy package scope member VDOM.
      type: String
    - contextPath: FortiManager.PolicyPackage.subobj
      description: Policy package sub-objects.
      type: Unknown
    - contextPath: FortiManager.PolicyPackage.type
      description: Policy package type.
      type: String
  - arguments:
    - description: The ADOM on which to create the service group. Leave empty to use
        the instance ADOM.
      name: adom
    - description: The name of the new policy package.
      name: name
      required: true
    - auto: PREDEFINED
      description: 'The type of package. Possible values are: "pkg" and "folder".'
      name: type
      predefined:
      - pkg
      - folder
      required: true
    - auto: PREDEFINED
      defaultValue: disable
      description: Whether to use central NAT. Default is "disable".
      name: central_nat
      predefined:
      - enable
      - disable
    - auto: PREDEFINED
      defaultValue: disable
      description: Whether to enable consolidate firewall mode. Default is "disable".
      name: consolidated_firewall_mode
      predefined:
      - enable
      - disable
    - auto: PREDEFINED
      defaultValue: disable
      description: Whether to enable firewall policy implicit log. Default is "disable".
      name: fwpolicy_implicit_log
      predefined:
      - enable
      - disable
    - auto: PREDEFINED
      defaultValue: disable
      description: Whether to enable firewall policy 6 implicit log. Default is "disable".
      name: fwpolicy6_implicit_log
      predefined:
      - enable
      - disable
    - auto: PREDEFINED
      defaultValue: proxy
      description: 'Package inspection mode. Possible values are: "proxy" and "flow".
        Default is "proxy".'
      name: inspection_mode
      predefined:
      - proxy
      - flow
    - auto: PREDEFINED
      defaultValue: profile-based
      description: 'Package NGFW mode. Possible values are: "profile-based" and "policy-based".
        Default is "profile-based".'
      name: ngfw_mode
      predefined:
      - profile-based
      - policy-based
    - description: Package SSL SSH profile.
      name: ssl_ssh_profile
      predefined:
      - ""
    description: Create a new firewall policy package.
    name: fortimanager-firewall-policy-package-create
  - arguments:
    - description: The ADOM on which to update the service group. Leave empty to use
        the instance ADOM.
      name: adom
    - description: The name of the Policy Package to update.
      name: name
      required: true
    - auto: PREDEFINED
      description: 'The type og package. Possible values are: "pkg" and "folder".'
      name: type
      predefined:
      - pkg
      - folder
    - auto: PREDEFINED
      description: Whether to use central NAT.
      name: central_nat
      predefined:
      - enable
      - disable
    - auto: PREDEFINED
      description: Whether to enable consolidate firewall mode.
      name: consolidated_firewall_mode
      predefined:
      - enable
      - disable
    - auto: PREDEFINED
      description: Whether to enable firewall policy implicit log.
      name: fwpolicy_implicit_log
      predefined:
      - enable
      - disable
    - auto: PREDEFINED
      description: Whether to enable firewall policy 6 implicit log.
      name: fwpolicy6_implicit_log
      predefined:
      - enable
      - disable
    - auto: PREDEFINED
      description: 'Package inspection mode. Possible values are: "proxy" and "flow".'
      name: inspection_mode
      predefined:
      - proxy
      - flow
    - auto: PREDEFINED
      description: 'Package NGFW mode. Possible values are: "profile-based" and "policy-based".'
      name: ngfw_mode
      predefined:
      - profile-based
      - policy-based
    - description: Package SSL SSH profile.
      name: ssl_ssh_profile
      predefined:
      - ""
    description: Create a new firewall policy package.
    name: fortimanager-firewall-policy-package-update
  - arguments:
    - description: The ADOM from which to delete the policy package. Leave empty to
        use the default integration ADOM.
      name: adom
    - description: The policy package path to delete.
      name: pkg_path
      required: true
    description: Delete a firewall policy package.
    name: fortimanager-firewall-policy-package-delete
  - arguments:
    - description: The package from which to fetch the policies.
      name: package
      required: true
    - description: The ADOM from which to fetch the policies. Leave empty to use the
        instance ADOM.
      name: adom
    - auto: PREDEFINED
      defaultValue: "0"
      description: From which index to start the list. Default is 0.
      name: offset
      predefined:
      - "50"
    - description: To which index to get the list.
      name: limit
    - description: An ID for the specific policy to fetch. If not specified, will
        get all policies.
      name: policy_id
    description: List specific firewall policies from a policy package.
    name: fortimanager-firewall-policy-list
    outputs:
    - contextPath: FortiManager.PolicyPackage.Policy.action
      description: Policy action (allow/deny/ipsec).
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.app-category
      description: Application category ID list.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.app-group
      description: Application group names.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.application
      description: Application ID list.
      type: Number
    - contextPath: FortiManager.PolicyPackage.Policy.application-list
      description: Name of an existing application list.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.auth-cert
      description: HTTPS server certificate for policy authentication.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.auth-path
      description: Enable/disable authentication-based routing.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.auth-redirect-addr
      description: HTTP-to-HTTPS redirect address for firewall authentication.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.auto-asic-offload
      description: Enable/disable offloading security profile processing to CP processors.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.av-profile
      description: Name of an existing antivirus profile.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.block-notification
      description: Enable/disable block notification.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.captive-portal-exempt
      description: Enable to exempt some users from the captive portal.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.capture-packet
      description: Enable/disable capture packets.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.comments
      description: Comments.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.custom-log-fields
      description: Custom fields to append to log messages for this policy.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.delay-tcp-npu-session
      description: Enable TCP NPU session delay to guarantee packet order of 3-way
        handshake.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.devices
      description: Names of devices or device groups that can be matched by the policy.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.diffserv-forward
      description: Enable to change packet DiffServ values to the specified diffservcode-forward
        value.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.diffserv-reverse
      description: Enable to change packet reverse (reply) DiffServ values to the
        specified diffservcode-rev value.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.diffservcode-forward
      description: Change packet DiffServ to this value.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.diffservcode-rev
      description: Change packet reverse (reply) DiffServ to this value.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.disclaimer
      description: Enable/disable user authentication disclaimer.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.dlp-sensor
      description: Name of an existing DLP sensor.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.dnsfilter-profile
      description: Name of an existing DNS filter profile.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.dscp-match
      description: Enable DSCP check.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.dscp-negate
      description: Enable negated DSCP match.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.dscp-value
      description: DSCP value.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.dsri
      description: Enable DSRI to ignore HTTP server responses.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.dstaddr
      description: Destination address and address group names.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.dstaddr-negate
      description: When enabled, dstaddr specifies what the destination address must
        NOT be.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.dstintf
      description: Outgoing (egress) interface.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.firewall-session-dirty
      description: How to handle sessions if the configuration of this firewall policy
        changes.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.fixedport
      description: Enable to prevent source NAT from changing a session source port.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.fsso
      description: Enable/disable Fortinet single sign-on.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.fsso-agent-for-ntlm
      description: FSSO agent to use for NTLM authentication.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.global-label
      description: Label for the policy that appears when the GUI is in Global View
        mode.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.groups
      description: Names of user groups that can authenticate with this policy.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.gtp-profile
      description: GTP profile.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.icap-profile
      description: Name of an existing ICAP profile.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.identity-based-route
      description: Name of identity-based routing rule.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.inbound
      description: Policy-based IPsec VPN. Only traffic from the remote network can
        initiate a VPN.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.internet-service
      description: Enable/disable use of internet services for this policy. If enabled,
        destination address and service are not used.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.internet-service-custom
      description: Custom internet service name.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.internet-service-id
      description: Internet service ID.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.internet-service-negate
      description: When enabled, internet service specifies what the service must
        NOT be.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.internet-service-src
      description: Enable/disable use of internet services in source for this policy.
        If enabled, source address is not used.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.internet-service-src-custom
      description: Custom internet service source name.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.internet-service-src-id
      description: Internet service source ID.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.internet-service-src-negate
      description: When enabled, internet-service-src specifies what the service must
        NOT be.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.ippool
      description: Enable to use IP pools for source NAT.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.ips-sensor
      description: Name of an existing IPS sensor.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.label
      description: Label for the policy that appears when the GUI is in Section View
        mode.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.learning-mode
      description: Enable to allow everything, but log all of the meaningful data
        for security information gathering. A learning report will be generated.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.logtraffic
      description: Enable or disable logging. Log all sessions or security profile
        sessions.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.logtraffic-start
      description: Record logs when a session starts and ends.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.match-vip
      description: Enable to match packets that have had their destination addresses
        changed by a VIP.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.mms-profile
      description: Name of an existing MMS profile.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.name
      description: Policy name.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.nat
      description: Enable/disable a source NAT.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.natinbound
      description: 'Policy-based IPsec VPN: apply destination NAT to inbound traffic.'
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.natip
      description: 'Policy-based IPsec VPN: source NAT IP address for outgoing traffic.'
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.natoutbound
      description: 'Policy-based IPsec VPN: apply source NAT to outbound traffic.'
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.np-acceleration
      description: Enable/disable UTM Network Processor acceleration.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.ntlm
      description: Enable/disable NTLM authentication.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.ntlm-enabled-browsers
      description: HTTP-User-Agent value of supported browsers.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.ntlm-guest
      description: Enable/disable NTLM guest user access.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.outbound
      description: 'Policy-based IPsec VPN: only traffic from the internal network
        can initiate a VPN.'
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.per-ip-shaper
      description: Per-IP traffic shaper.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.permit-any-host
      description: Accept UDP packets from any host.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.permit-stun-host
      description: Accept UDP packets from any Session Traversal Utilities for NAT
        (STUN) host.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.policyid
      description: Policy ID.
      type: Number
    - contextPath: FortiManager.PolicyPackage.Policy.poolname
      description: IP pool names.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.profile-group
      description: Name of profile group.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.profile-protocol-options
      description: Name of an existing protocol options profile.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.profile-type
      description: Determine whether the firewall policy allows security profile groups
        or single profiles only.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.radius-mac-auth-bypass
      description: Enable MAC authentication bypass. The bypassed MAC address must
        be received from RADIUS server.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.redirect-url
      description: The URL users are directed to after seeing and accepting the disclaimer
        or authenticating.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.replacemsg-override-group
      description: Override the default replacement message group for this policy.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.rsso
      description: Enable/disable RADIUS single sign-on (RSSO).
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.rtp-addr
      description: Address names if this is an RTP NAT policy.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.rtp-nat
      description: Enable Real Time Protocol (RTP) NAT.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.scan-botnet-connections
      description: Block or monitor connections to Botnet servers or disable Botnet
        scanning.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.schedule
      description: Schedule name.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.schedule-timeout
      description: Enable to force current sessions to end when the schedule object
        times out. Disable allows them to end from inactivity.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.send-deny-packet
      description: Enable to send a reply when a session is denied or blocked by a
        firewall policy.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.service
      description: Service and service group names.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.service-negate
      description: When enabled, service specifies what the service must NOT be.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.session-ttl
      description: TTL in seconds for sessions accepted by this policy. (0 means use
        the system default session TTL.)
      type: Number
    - contextPath: FortiManager.PolicyPackage.Policy.spamfilter-profile
      description: Name of an existing spam filter profile.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.srcaddr
      description: Source address and address group names.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.srcaddr-negate
      description: When enabled, srcaddr specifies what the source address must NOT
        be.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.srcintf
      description: Incoming (ingress) interface.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.ssh-filter-profile
      description: Name of an existing SSH filter profile.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.ssl-mirror
      description: Enable to copy decrypted SSL traffic to a FortiGate interface (called
        SSL mirroring).
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.ssl-mirror-intf
      description: SSL mirror interface name.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.ssl-ssh-profile
      description: Name of an existing SSL SSH profile.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.status
      description: Enable or disable this policy.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.tcp-mss-receiver
      description: Receiver TCP maximum segment size (MSS).
      type: Number
    - contextPath: FortiManager.PolicyPackage.Policy.tcp-mss-sender
      description: Sender TCP maximum segment size (MSS).
      type: Number
    - contextPath: FortiManager.PolicyPackage.Policy.tcp-session-without-syn
      description: Enable/disable creation of TCP session without SYN flag.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.timeout-send-rst
      description: Enable/disable sending RST packets when TCP sessions expire.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.traffic-shaper
      description: Traffic shaper.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.traffic-shaper-reverse
      description: Reverse traffic shaper.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.url-category
      description: URL category ID list.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.users
      description: Names of individual users that can authenticate with this policy.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.utm-status
      description: Enable to add one or more security profiles (AV, IPS, etc.) to
        the firewall policy.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.uuid
      description: Universally Unique Identifier (UUID; automatically assigned but
        can be manually reset).
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.vlan-cos-fwd
      description: 'VLAN forward direction user priority: 255 passthrough, 0 lowest,
        7 highest.'
      type: Number
    - contextPath: FortiManager.PolicyPackage.Policy.vlan-cos-rev
      description: 'VLAN reverse direction user priority: 255 passthrough, 0 lowest,
        7 highest.'
      type: Number
    - contextPath: FortiManager.PolicyPackage.Policy.vlan-filter
      description: Set VLAN filters.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.voip-profile
      description: Name of an existing VoIP profile.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.vpn_dst_node.host
      description: VPN destination node host.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.vpn_dst_node.seq
      description: VPN destination node sequence.
      type: Number
    - contextPath: FortiManager.PolicyPackage.Policy.vpn_dst_node.subnet
      description: VPN destination node subnet.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.vpn_src_node.host
      description: VPN source node host.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.vpn_src_node.seq
      description: VPN source node sequence.
      type: Number
    - contextPath: FortiManager.PolicyPackage.Policy.vpn_src_node.subnet
      description: VPN source node subnet.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.vpntunnel
      description: 'Policy-based IPsec VPN: name of the IPsec VPN Phase 1.'
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.waf-profile
      description: Name of an existing Web application firewall profile.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.wanopt
      description: Enable/disable WAN optimization.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.wanopt-detection
      description: WAN optimization auto-detection mode.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.wanopt-passive-opt
      description: WAN optimization passive mode options. This option decides what
        IP address will be used to connect server.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.wanopt-peer
      description: WAN optimization peer.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.wanopt-profile
      description: WAN optimization profile.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.wccp
      description: Enable/disable forwarding traffic matching this policy to a configured
        WCCP server.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.webcache
      description: Enable/disable a web cache.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.webcache-https
      description: Enable/disable a web cache for HTTPS.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.webfilter-profile
      description: Name of an existing Web filter profile.
      type: String
    - contextPath: FortiManager.PolicyPackage.Policy.wsso
      description: Enable/disable WiFi single sign-on (WSSO).
      type: String
  - arguments:
    - description: The ADOM on which to create the service group. Leave empty to use
        the instance ADOM.
      name: adom
    - description: The package from which to create the policy.
      name: package
      required: true
    - auto: PREDEFINED
      description: 'The policy action. Possible values are: "deny", "accept", "ipsec",
        and "ssl-vpn".'
      name: action
      predefined:
      - deny
      - accept
      - ipsec
      - ssl-vpn
      required: true
    - description: A comment.
      name: comments
    - description: 'Destination address name. Note: dstaddr6 or dstaddr must be set.'
      name: dstaddr
    - description: 'IPv6 destination address (web proxy only). Note: dstaddr6 or dstaddr
        must be set.'
      name: dstaddr6
    - auto: PREDEFINED
      description: Enable/disable a negated destination address match.
      name: dstaddr_negate
      predefined:
      - disable
      - enable
    - defaultValue: any
      description: Destination interface name.
      name: dstintf
    - description: 'Source address name. Note: srcaddr or srcaddr6 must be set.'
      name: srcaddr
    - description: 'IPv6 source address (web proxy only). Note: srcaddr or srcaddr6
        must be set.'
      name: srcaddr6
    - auto: PREDEFINED
      description: Enable/disable a negated source address match.
      name: srcaddr_negate
      predefined:
      - disable
      - enable
    - defaultValue: any
      description: Source interface name.
      name: srcintf
    - description: 'A comma-separated list of additional params and their values.
        For example: Field1=Value1,Field2=Value2.'
      name: additional_params
    - description: The name of the policy to create.
      name: name
      required: true
    - auto: PREDEFINED
      defaultValue: utm
      description: 'Enable or disable logging. Log all sessions or security profile
        sessions. Possible values are: "enable", "disable", "all", and "utm".'
      name: logtraffic
      predefined:
      - enable
      - disable
      - all
      - utm
      required: true
    - defaultValue: always
      description: Schedule name. Default is "always".
      name: schedule
      required: true
    - defaultValue: ALL
      description: Service and service group names. Default is "ALL".
      name: service
      required: true
    - auto: PREDEFINED
      defaultValue: enable
      description: Enable or disable this policy.
      name: status
      predefined:
      - enable
      - disable
      required: true
    - description: The ID of the policy to create. Leave empty to use system default.
      name: policyid
    description: Create a firewall policy.
    name: fortimanager-firewall-policy-create
  - arguments:
    - description: The ADOM on which to update the service group. Leave empty to use
        the instance ADOM.
      name: adom
    - description: The package from which to update the policy.
      name: package
      required: true
    - auto: PREDEFINED
      description: 'The policy action. Possible values are: "deny", "accept", "ipsec",
        and "ssl-vpn".'
      name: action
      predefined:
      - deny
      - accept
      - ipsec
      - ssl-vpn
    - description: A comment.
      name: comments
    - description: 'Destination address name. Note: dstaddr6 or dstaddr must be set.'
      name: dstaddr
    - description: 'IPv6 destination address (web proxy only). Note: dstaddr6 or dstaddr
        must be set.'
      name: dstaddr6
    - auto: PREDEFINED
      description: Enable/disable a negated destination address match.
      name: dstaddr_negate
      predefined:
      - disable
      - enable
    - description: Destination interface name.
      name: dstintf
    - description: 'Source address name. Note: srcaddr or srcaddr6 must be set.'
      name: srcaddr
    - description: 'IPv6 source address (web proxy only). Note: srcaddr or srcaddr6
        must be set.'
      name: srcaddr6
    - auto: PREDEFINED
      description: Enable/disable a negated source address match.
      name: srcaddr_negate
      predefined:
      - disable
      - enable
    - description: Source interface name.
      name: srcintf
    - description: 'A comma-separated list of additional params and their values.
        exmaple: Field1=Value1,Field2=Value2.'
      name: additional_params
    - description: The name of the policy to update.
      name: name
    - auto: PREDEFINED
      description: 'Enable or disable logging. Log all sessions or security profile
        sessions. Possible values are: "enable", "disable", "all", and "utm".'
      name: logtraffic
      predefined:
      - enable
      - disable
      - all
      - utm
    - description: Schedule name.
      name: schedule
    - description: Service and service group names.
      name: service
    - auto: PREDEFINED
      description: Enable or disable this policy.
      name: status
      predefined:
      - enable
      - disable
    - description: The ID of the policy to update.
      name: policyid
      required: true
    description: Update a firewall policy.
    name: fortimanager-firewall-policy-update
  - arguments:
    - description: The ADOM from which to delete the policy. Leave empty to use the
        default integration ADOM.
      name: adom
    - description: The policy package from which we want to delete the policy.
      name: package
      required: true
    - description: The policy we want to delete.
      name: policy
      required: true
    description: Delete a firewall policy.
    name: fortimanager-firewall-policy-delete
  - arguments:
    - description: The ADOM from which to move the policy. Leave empty to use the
        default integration ADOM.
      name: adom
    - description: The policy package from which we want to move the policy.
      name: package
      required: true
    - description: The ID of the policy we want to move.
      name: policy
      required: true
    - description: The ID of the target policy by which we want to move the policy.
      name: target
      required: true
    - auto: PREDEFINED
      defaultValue: before
      description: 'Whether to move the policy before or after the target policy.
        Possible values are: "before" and "after". Default is "before".'
      name: option
      predefined:
      - before
      - after
      required: true
    description: Move a policy in the package.
    name: fortimanager-firewall-policy-move
  - arguments:
    - description: The ADOM from which to list dynamic interfaces. Leave empty to
        use the default integration ADOM.
      name: adom
    - defaultValue: "0"
      description: From which index to start the list. Default is 0.
      name: offset
    - defaultValue: "50"
      description: To which index to get the list. Default is 50.
      name: limit
    description: List dynamic interfaces
    name: fortimanager-dynamic-interface-list
    outputs:
    - contextPath: FortiManager.DynamicInterface.color
      description: Color of the icon in the GUI.
      type: Number
    - contextPath: FortiManager.DynamicInterface.default-mapping
      description: Default mapping of the Interface.
      type: String
    - contextPath: FortiManager.DynamicInterface.defmap-intf
      description: Default mapping interface.
      type: String
    - contextPath: FortiManager.DynamicInterface.defmap-intrazone-deny
      description: Default mapping intrazone deny.
      type: String
    - contextPath: FortiManager.DynamicInterface.defmap-zonemember
      description: Default mapping zone members
      type: String
    - contextPath: FortiManager.DynamicInterface.description
      description: Dynamic interface description.
      type: String
    - contextPath: FortiManager.DynamicInterface.dynamic_mapping._scope.name
      description: Dynamic mapping scope name.
      type: String
    - contextPath: FortiManager.DynamicInterface.dynamic_mapping._scope.vdom
      description: Dynamic mapping scope VDOM.
      type: String
    - contextPath: FortiManager.DynamicInterface.dynamic_mapping.egress-shaping-profile
      description: Dynamic mapping egress shaping profile.
      type: String
    - contextPath: FortiManager.DynamicInterface.dynamic_mapping.intrazone-deny
      description: Dynamic mapping intrazone deny.
      type: String
    - contextPath: FortiManager.DynamicInterface.dynamic_mapping.local-intf
      description: Dynamic mapping local interface.
      type: String
    - contextPath: FortiManager.DynamicInterface.egress-shaping-profile
      description: Egress shaping profile.
      type: String
    - contextPath: FortiManager.DynamicInterface.name
      description: Dynamic interface name.
      type: String
    - contextPath: FortiManager.DynamicInterface.platform_mapping.egress-shaping-profile
      description: Platform mapping egress shaping profile.
      type: String
    - contextPath: FortiManager.DynamicInterface.platform_mapping.intf-zone
      description: Platform mapping interface zone.
      type: String
    - contextPath: FortiManager.DynamicInterface.platform_mapping.intrazone-deny
      description: Platform mapping intrazone deny.
      type: String
    - contextPath: FortiManager.DynamicInterface.platform_mapping.name
      description: Platform mapping name.
      type: String
    - contextPath: FortiManager.DynamicInterface.single-intf
      description: Dynamic interface single interface.
      type: String
  - arguments:
    - description: The comment for the new ADOM revision.
      name: adom_rev_comment
    - description: The name for the new ADOM revision.
      name: adom_rev_name
    - description: The ADOM in which to install the policy package. Leave empty to
        use the default integration ADOM.
      name: adom
    - description: The comment for the device configuration revision that will be
        generated during install.
      name: dev_rev_comment
    - description: The policy package to install.
      name: package
      required: true
    - description: The device or device group name on which to install the package.
      name: name
      required: true
    - description: vdom on which to install the package.
      name: vdom
    description: Schedule a policy package installation.
    name: fortimanager-firewall-policy-package-install
    outputs:
    - contextPath: FortiManager.Installation.id
      description: The installation task ID.
      type: Number
  - arguments:
    - description: The installation task ID.
      name: task_id
      required: true
    description: Get installation status.
    name: fortimanager-firewall-policy-package-install-status
    outputs:
    - contextPath: FortiManager.Installation.adom
      description: The ADOM on which the installation occurred.
      type: Number
    - contextPath: FortiManager.Installation.end_tm
      description: The installation task end time.
      type: Number
    - contextPath: FortiManager.Installation.flags
      description: The installation_task_flags.
      type: Number
    - contextPath: FortiManager.Installation.id
      description: The installation task ID.
      type: Number
    - contextPath: FortiManager.Installation.line.detail
      description: The installation status details.
      type: String
    - contextPath: FortiManager.Installation.line.end_tm
      description: The installation task end time.
      type: Number
    - contextPath: FortiManager.Installation.line.err
      description: The installation error.
      type: Number
    - contextPath: FortiManager.Installation.line.history
      description: Installation task historical details.
      type: String
    - contextPath: FortiManager.Installation.line.ip
      description: The installation IP.
      type: String
    - contextPath: FortiManager.Installation.line.name
      description: The installation name.
      type: String
    - contextPath: FortiManager.Installation.line.oid
      description: The installation task oid.
      type: Number
    - contextPath: FortiManager.Installation.line.percent
      description: The installation task completion percent.
      type: Number
    - contextPath: FortiManager.Installation.line.start_tm
      description: The installation task start time.
      type: Number
    - contextPath: FortiManager.Installation.line.state
      description: The installation task state.
      type: String
    - contextPath: FortiManager.Installation.line.vdom
      description: The VDOM on which the installation occurred.
      type: String
    - contextPath: FortiManager.Installation.num_done
      description: The number of done tasks.
      type: Number
    - contextPath: FortiManager.Installation.num_err
      description: The number of errors found.
      type: Number
    - contextPath: FortiManager.Installation.num_lines
      description: The number of installation data lines.
      type: Number
    - contextPath: FortiManager.Installation.num_warn
      description: The number of warnings found.
      type: Number
    - contextPath: FortiManager.Installation.percent
      description: The installation task completion percent.
      type: Number
    - contextPath: FortiManager.Installation.pid
      description: The installation task PID.
      type: Number
    - contextPath: FortiManager.Installation.src
      description: The installation task source
      type: String
    - contextPath: FortiManager.Installation.start_tm
      description: The installation task start time.
      type: Number
    - contextPath: FortiManager.Installation.state
      description: The installation task state.
      type: String
    - contextPath: FortiManager.Installation.title
      description: The installation task title.
      type: String
    - contextPath: FortiManager.Installation.tot_percent
      description: The installation task completion percent.
      type: Number
    - contextPath: FortiManager.Installation.user
      description: The installation task user.
      type: String
  dockerimage: demisto/python3:3.10.12.63474
  runonce: false
  script: |
    register_module_line('FortiManager', 'start', __line__())
    ### pack version: 1.0.7




    import urllib3
    from typing import Dict

    # Disable insecure warnings
    urllib3.disable_warnings()

    ''' CONSTANTS '''

    GLOBAL_VAR = 'global'

    ''' CLIENT CLASS '''


    class Client(BaseClient):

        def __init__(self, url: str, credentials: Dict, verify: bool, proxy: bool, adom: str):
            super().__init__(base_url=url.rstrip('/'), verify=verify, proxy=proxy, ok_codes=(200, 204))
            handle_proxy()
            self.username = credentials["identifier"]
            self.password = credentials["password"]
            self.session_token = self.get_session_token()
            self.adom = adom

        def get_session_token(self, get_new_token: bool = False):
            if get_new_token:
                response = self.fortimanager_http_request('exec', "/sys/login/user",
                                                          json_data={'user': self.username, 'passwd': self.password},
                                                          add_session_token=False)

                if response.get('result')[0].get('status', {}).get('code') != 0:
                    raise DemistoException(f"Unable to get new session token. Reason - "
                                           f"{response.get('result')[0].get('status').get('message')}")

                demisto.setIntegrationContext({'session': response.get('session')})
                return response.get('session')

            else:
                current_token = demisto.getIntegrationContext().get('session')
                return current_token if current_token else self.get_session_token(get_new_token=True)

        def fortimanager_http_request(self, method: str, url: str, data_in_list: Dict = None, json_data: Dict = None,
                                      range_info: List = None, other_params: Dict = None, add_session_token: bool = True):
            body: Dict = {
                "id": 1,
                "method": method,
                "verbose": 1,
                "params": [{
                    "option": "object member",
                    "url": url
                }],
            }

            if add_session_token:
                body['session'] = self.session_token

            if data_in_list:
                body['params'][0]['data'] = [data_in_list]

            if json_data:
                body['params'][0]['data'] = json_data

            if range_info:
                body['params'][0]['range'] = range_info

            if other_params:
                for param in other_params:
                    body['params'][0][param] = other_params.get(param)

            response = self._http_request(
                method='POST',
                url_suffix='jsonrpc',
                json_data=body
            )
            return response

        def fortimanager_api_call(self, method: str, url: str, data_in_list: Dict = None, json_data: Dict = None,
                                  range_info: List = None, other_params: Dict = None):
            response = self.fortimanager_http_request(method, url, data_in_list=data_in_list, range_info=range_info,
                                                      other_params=other_params, json_data=json_data)

            # catch session token expiration - fetch new token and retry
            if response.get('result')[0].get('status', {}).get('code') == -11:
                self.session_token = self.get_session_token(get_new_token=True)
                response = self.fortimanager_http_request(method, url, data_in_list=data_in_list, range_info=range_info,
                                                          other_params=other_params, json_data=json_data)

            if response.get('result')[0].get('status', {}).get('code') != 0:
                raise DemistoException(response.get('result')[0].get('status').get('message'))

            return response.get('result')[0].get('data')


    def get_global_or_adom(client: Client, args: Dict):
        """Get the ADOM scope on which the command should run.
        If 'adom' command argument is entered use it, otherwise use the default client ADOM parameter.

        """
        adom = args.get('adom') if args.get('adom') else client.adom
        # if the command is reffereing to a specified ADOM then the command should return "adom/{adom_name}"
        # if it refferes to the general system then we should return "global"
        if adom == GLOBAL_VAR:
            return GLOBAL_VAR
        else:
            return f"adom/{adom}"


    def setup_request_data(args: Dict, excluded_args: List):
        return {key.replace('_', '-'): args.get(key) for key in args if key not in excluded_args}


    def get_specific_entity(entity_name: str):
        if entity_name:
            return f"/{entity_name}"
        else:
            return ""


    def get_range_for_list_command(args: Dict):
        first_index = args.get('offset', 0)
        last_index = int(args.get('limit', 50)) - 1
        list_range = []

        # A bug on Forti API when the first index is 0, need to add 1 to the last index for consistency
        if int(first_index) == 0:
            list_range.append(0)
            list_range.append(int(last_index) + 1)

        else:
            list_range.append(int(first_index))
            list_range.append(int(last_index))

        return list_range


    def split_param(args, name, default_val='', skip_if_none=False):
        if not skip_if_none or (skip_if_none and args.get(name)):
            args[name] = args.get(name, default_val).split(',')


    def resolve_enum(entity_object, field_name, enum_dict):
        """
        Method resolves enum values to
        """
        if type(entity_object) == list:
            for entity in entity_object:
                if field_name in entity:
                    entity[field_name] = enum_dict.get(entity[field_name], entity[field_name])

        else:
            if field_name in entity_object:
                entity_object[field_name] = enum_dict.get(entity_object[field_name], entity_object[field_name])


    def list_adom_devices_command(client, args):
        devices_data = client.fortimanager_api_call("get", f"/dvmdb/{get_global_or_adom(client, args)}/device"
                                                           f"{get_specific_entity(args.get('device'))}",
                                                    range_info=get_range_for_list_command(args))

        headers = ['name', 'ip', 'hostname', 'os_type', 'adm_usr', 'app_ver', 'vdom', 'ha_mode']

        # Only show vdom names in human readable
        hr_devices_data = devices_data
        if type(devices_data) == list:
            for device in devices_data:
                vdom_names = []
                for vdom in device.get('vdom', []):
                    if vdom.get('name'):
                        vdom_names.append(vdom.get('name'))
                hr_devices_data[devices_data.index(device)]['vdom'] = vdom_names

        else:
            vdom_names = []
            for vdom in devices_data.get('vdom', []):
                if vdom.get('name'):
                    vdom_names.append(vdom.get('name'))

            hr_devices_data['vdom'] = vdom_names

        return CommandResults(
            outputs_prefix='FortiManager.Device',
            outputs_key_field='name',
            outputs=devices_data,
            readable_output=tableToMarkdown(f"ADOM {get_global_or_adom(client, args)} Devices", hr_devices_data,
                                            removeNull=True, headerTransform=string_to_table_header, headers=headers),
            raw_response=devices_data,
        )


    def list_adom_devices_groups_command(client, args):
        device_groups_data = client.fortimanager_api_call("get", f"/dvmdb/{get_global_or_adom(client, args)}/group"
                                                                 f"{get_specific_entity(args.get('group'))}",
                                                          range_info=get_range_for_list_command(args))

        headers = ['name', 'type', 'os_type']

        return CommandResults(
            outputs_prefix='FortiManager.DeviceGroup',
            outputs_key_field='name',
            outputs=device_groups_data,
            readable_output=tableToMarkdown(f"ADOM {get_global_or_adom(client, args)} Device Groups", device_groups_data,
                                            removeNull=True, headerTransform=string_to_table_header, headers=headers),
            raw_response=device_groups_data,
        )


    def list_firewall_addresses_command(client, args):
        firewall_addresses = client.fortimanager_api_call("get", f"/pm/config/{get_global_or_adom(client, args)}"
                                                                 f"/obj/firewall/address"
                                                                 f"{get_specific_entity(args.get('address'))}",
                                                          range_info=get_range_for_list_command(args))

        headers = ['name', 'type', 'subnet', 'start-ip', 'end-ip', 'fqdkn', 'wildcard', 'country', 'wildcard-fqdn', 'sdn',
                   'comment'] if not args.get('address') else None

        return CommandResults(
            outputs_prefix='FortiManager.Address',
            outputs_key_field='name',
            outputs=firewall_addresses,
            readable_output=tableToMarkdown("Firewall IPv4 Addresses", firewall_addresses,
                                            removeNull=True, headerTransform=string_to_table_header, headers=headers),
            raw_response=firewall_addresses,
        )


    def create_address_command(client, args):
        client.fortimanager_api_call("add", f"/pm/config/{get_global_or_adom(client, args)}/obj/firewall/address",
                                     data_in_list=setup_request_data(args, ['adom']))

        return f"Created new Address {args.get('name')}"


    def update_address_command(client, args):
        client.fortimanager_api_call("update", f"/pm/config/{get_global_or_adom(client, args)}/obj/firewall/address",
                                     data_in_list=setup_request_data(args, ['adom']))

        return f"Updated Address {args.get('name')}"


    def delete_address_command(client, args):
        client.fortimanager_api_call("delete", f"/pm/config/{get_global_or_adom(client, args)}"
                                               f"/obj/firewall/address/{args.get('address')}")
        return f"Deleted Address {args.get('address')}"


    def list_address_groups_command(client, args):
        address_group = get_specific_entity(args.get('address_group'))
        firewall_address_groups = client.fortimanager_api_call("get", f"/pm/config/"
                                                                      f"{get_global_or_adom(client, args)}"
                                                                      f"/obj/firewall/addrgrp{address_group}",
                                                               range_info=get_range_for_list_command(args))

        headers = ['name', 'member', 'tagging', 'allow-routing', 'comment'] if not args.get('address_group') else None

        return CommandResults(
            outputs_prefix='FortiManager.AddressGroup',
            outputs_key_field='name',
            outputs=firewall_address_groups,
            readable_output=tableToMarkdown("Firewall IPv4 Address Groups", firewall_address_groups,
                                            removeNull=True, headerTransform=string_to_table_header, headers=headers),
            raw_response=firewall_address_groups,
        )


    def create_address_group_command(client, args):
        data = setup_request_data(args, ['adom'])
        data['member'] = data.get('member').split(',')
        client.fortimanager_api_call("add", f"/pm/config/{get_global_or_adom(client, args)}/obj/firewall/addrgrp",
                                     data_in_list=data)

        return f"Created new Address Group {args.get('name')}"


    def update_address_group_command(client, args):
        data = setup_request_data(args, ['adom'])
        data['member'] = data.get('member').split(',')
        client.fortimanager_api_call("update", f"/pm/config/{get_global_or_adom(client, args)}/obj/firewall/addrgrp",
                                     data_in_list=data)

        return f"Updated Address Group {args.get('name')}"


    def delete_address_group_command(client, args):
        client.fortimanager_api_call("delete", f"/pm/config/{get_global_or_adom(client, args)}"
                                               f"/obj/firewall/addrgrp/{args.get('address_group')}")
        return f"Deleted Address Group {args.get('address_group')}"


    def list_service_categories_command(client, args):
        service_categories = client.fortimanager_api_call("get", f"/pm/config/"
                                                                 f"{get_global_or_adom(client, args)}/"
                                                                 f"obj/firewall/service/category"
                                                                 f"{get_specific_entity(args.get('service_category'))}",
                                                          range_info=get_range_for_list_command(args))
        headers = ['name', 'comment']

        return CommandResults(
            outputs_prefix='FortiManager.ServiceCategory',
            outputs_key_field='name',
            outputs=service_categories,
            readable_output=tableToMarkdown("Service Categories", service_categories, removeNull=True,
                                            headerTransform=string_to_table_header, headers=headers),
            raw_response=service_categories,
        )


    def list_service_groups_command(client, args):
        service_groups = client.fortimanager_api_call("get", f"/pm/config/"
                                                             f"{get_global_or_adom(client, args)}"
                                                             f"/obj/firewall/service/group"
                                                             f"{get_specific_entity(args.get('service_group'))}",
                                                      range_info=get_range_for_list_command(args))

        headers = ['name', 'member', 'proxy', 'comment'] if not args.get('service_group') else None

        return CommandResults(
            outputs_prefix='FortiManager.ServiceGroup',
            outputs_key_field='name',
            outputs=service_groups,
            readable_output=tableToMarkdown("Service Groups", service_groups, removeNull=True,
                                            headerTransform=string_to_table_header, headers=headers),
            raw_response=service_groups,
        )


    def create_service_group_command(client, args):
        data = setup_request_data(args, ['adom'])
        data['member'] = data.get('member').split(',')
        client.fortimanager_api_call("add", f"/pm/config/{get_global_or_adom(client, args)}/obj/firewall/service/group",
                                     data_in_list=data)

        return f"Created new Service Group {args.get('name')}"


    def update_service_group_command(client, args):
        data = setup_request_data(args, ['adom'])
        data['member'] = data.get('member').split(',') if data.get('member') else None
        client.fortimanager_api_call("update", f"/pm/config/{get_global_or_adom(client, args)}/obj/firewall/service/group",
                                     data_in_list=data)

        return f"Updated Service Group {args.get('name')}"


    def delete_service_group_command(client, args):
        client.fortimanager_api_call("delete", f"/pm/config/{get_global_or_adom(client, args)}"
                                               f"/obj/firewall/service/group/{args.get('service_group')}")
        return f"Deleted Service Group {args.get('service_group')}"


    def list_custom_service_command(client, args):
        custom_services = client.fortimanager_api_call("get", f"/pm/config/"
                                                              f"{get_global_or_adom(client, args)}"
                                                              f"/obj/firewall/service/custom"
                                                              f"{get_specific_entity(args.get('custom_service'))}",
                                                       range_info=get_range_for_list_command(args))

        headers = ['name', 'category', 'protocol', 'iprange', 'fqdn', 'comment'] if not args.get('custom_service') else None

        return CommandResults(
            outputs_prefix='FortiManager.CustomService',
            outputs_key_field='name',
            outputs=custom_services,
            readable_output=tableToMarkdown("Custom Services", custom_services, removeNull=True,
                                            headerTransform=string_to_table_header, headers=headers),
            raw_response=custom_services,
        )


    def create_custom_service_command(client, args):
        client.fortimanager_api_call("add", f"/pm/config/{get_global_or_adom(client, args)}/obj/firewall/service/custom",
                                     data_in_list=setup_request_data(args, ['adom']))
        return f"Created new Custom Service {args.get('name')}"


    def update_custom_service_command(client, args):
        client.fortimanager_api_call("update", f"/pm/config/{get_global_or_adom(client, args)}/obj/firewall/service/custom",
                                     data_in_list=setup_request_data(args, ['adom']))
        return f"Updated Custom Service {args.get('name')}"


    def delete_custom_service_command(client, args):
        client.fortimanager_api_call("delete", f"/pm/config/{get_global_or_adom(client, args)}"
                                               f"/obj/firewall/service/custom/{args.get('custom')}")
        return f"Deleted Custom Service {args.get('custom')}"


    def list_policy_packages_command(client, args):
        policy_packages = client.fortimanager_api_call("get", f"pm/pkg/{get_global_or_adom(client, args)}"
                                                              f"{get_specific_entity(args.get('policy_package'))}")

        # No native range filter in API call, implementing manually
        from_val = int(args.get('offset', 0))
        to_val = args.get('limit')
        if not args.get('limit'):
            policy_packages = policy_packages[from_val:]

        else:
            policy_packages = policy_packages[from_val:int(to_val)]

        headers = ['name', 'obj_ver', 'type', 'scope_member'] if not args.get('policy_package') else None

        return CommandResults(
            outputs_prefix='FortiManager.PolicyPackage',
            outputs_key_field='name',
            outputs=policy_packages,
            readable_output=tableToMarkdown("Policy Packages", policy_packages, removeNull=True,
                                            headerTransform=string_to_table_header, headers=headers),
            raw_response=policy_packages,
        )


    def create_policy_package_command(client, args):
        package_settings = {
            'central-nat': args.get('central_nat'),
            'consolidated-firewall': args.get('consolidated_firewall'),
            'fwpolicy-implicit-log': args.get('fwpolicy_implicit_log'),
            'fwpolicy6-implicit-log': args.get('fwpolicy6_implicit_log'),
            'inspection-mode': args.get('inspection_mode'),
            'ngfw-mode': args.get('ngfw_mode'),
            'ssl-ssh-profile': args.get('ssl_ssh_profile')
        }

        args['package settings'] = package_settings
        client.fortimanager_api_call("add", f"pm/pkg/{get_global_or_adom(client, args)}",
                                     data_in_list=setup_request_data(args, ['adom', 'central_nat', 'consolidated_firewall',
                                                                            'fwpolicy_implicit_log',
                                                                            'fwpolicy6_implicit_log', 'inspection_mode',
                                                                            'ngfw_mode', 'ssl_ssh_profile']))

        return f"Created new Policy Package {args.get('name')}"


    def update_policy_package_command(client, args):
        package_settings = {
            'central-nat': args.get('central_nat'),
            'consolidated-firewall': args.get('consolidated_firewall'),
            'fwpolicy-implicit-log': args.get('fwpolicy_implicit_log'),
            'fwpolicy6-implicit-log': args.get('fwpolicy6_implicit_log'),
            'inspection-mode': args.get('inspection_mode'),
            'ngfw-mode': args.get('ngfw_mode'),
            'ssl-ssh-profile': args.get('ssl_ssh_profile')
        }

        args['package settings'] = package_settings
        client.fortimanager_api_call("update", f"pm/pkg/{get_global_or_adom(client, args)}",
                                     data_in_list=setup_request_data(args, ['adom', 'central_nat', 'consolidated_firewall',
                                                                            'fwpolicy_implicit_log',
                                                                            'fwpolicy6_implicit_log', 'inspection_mode',
                                                                            'ngfw_mode', 'ssl_ssh_profile']))

        return f"Update Policy Package {args.get('name')}"


    def delete_policy_package_command(client, args):
        client.fortimanager_api_call("delete", f"pm/pkg/{get_global_or_adom(client, args)}/{args.get('pkg_path')}")
        return f"Deleted Policy Package {args.get('pkg_path')}"


    def list_policies_command(client, args):
        policies = client.fortimanager_api_call("get", f"/pm/config/"
                                                       f"{get_global_or_adom(client, args)}"
                                                       f"/pkg/{args.get('package')}/firewall/policy"
                                                       f"{get_specific_entity(args.get('policy_id'))}",
                                                range_info=get_range_for_list_command(args))

        headers = ['policyid', 'name', 'srcintf', 'dstintf', 'srcaddr', 'dstaddr', 'schedule', 'service', 'users', 'action']

        return CommandResults(
            outputs_prefix='FortiManager.PolicyPackage.Policy',
            outputs_key_field='name',
            outputs=policies,
            readable_output=tableToMarkdown(f"ADOM {client.adom} Policy Package {args.get('package')} Policies",
                                            policies, removeNull=True, headerTransform=string_to_table_header,
                                            headers=headers),
            raw_response=policies,
        )


    def create_policy_command(client, args):
        if args.get('additional_params'):
            for additional_param in args.get('additional_params').split(','):
                field_and_value = additional_param.split('=')
                args[field_and_value[0]] = field_and_value[1]

        json_data = setup_request_data(args, ['adom', 'package', 'additional_params'])
        split_param(json_data, 'dstaddr', 'all', skip_if_none=True)
        split_param(json_data, 'dstaddr6', 'all', skip_if_none=True)
        split_param(json_data, 'dstintf', 'any')
        split_param(json_data, 'schedule', 'always')
        split_param(json_data, 'service', 'ALL')
        split_param(json_data, 'srcaddr', 'all', skip_if_none=True)
        split_param(json_data, 'srcaddr6', 'all', skip_if_none=True)
        split_param(json_data, 'srcintf', 'any')

        if not (json_data.get('dstaddr') or json_data.get('dstaddr6')):
            raise DemistoException("Please enter 'dstaddr' or 'dstaddr6' command arguments")

        if not (json_data.get('srcaddr') or json_data.get('srcaddr6')):
            raise DemistoException("Please enter 'srcaddr' or 'srcaddr6' command arguments")

        policies = client.fortimanager_api_call("add", f"/pm/config/"
                                                       f"{get_global_or_adom(client, args)}"
                                                       f"/pkg/{args.get('package')}/firewall/policy",
                                                json_data=json_data)

        return f"Created policy with ID {policies.get('policyid')}"


    def update_policy_command(client, args):
        if args.get('additional_params'):
            for additional_param in args.get('additional_params').split(','):
                field_and_value = additional_param.split('=')
                args[field_and_value[0]] = field_and_value[1]

        data = setup_request_data(args, ['adom', 'package', 'additional_params'])
        split_param(data, 'dstaddr', 'all', skip_if_none=True)
        split_param(data, 'dstaddr6', 'all', skip_if_none=True)
        split_param(data, 'dstintf', 'any', skip_if_none=True)
        split_param(data, 'schedule', 'always', skip_if_none=True)
        split_param(data, 'service', 'ALL', skip_if_none=True)
        split_param(data, 'srcaddr', 'all', skip_if_none=True)
        split_param(data, 'srcaddr6', 'all', skip_if_none=True)
        split_param(data, 'srcintf', 'any', skip_if_none=True)

        policies = client.fortimanager_api_call("update", f"/pm/config/"
                                                          f"{get_global_or_adom(client, args)}"
                                                          f"/pkg/{args.get('package')}/firewall/policy",
                                                data_in_list=data)

        return f"Updated policy with ID {policies.get('policyid')}"


    def delete_policy_command(client, args):
        client.fortimanager_api_call("delete", f"/pm/config/{get_global_or_adom(client, args)}/pkg/"
                                               f"{args.get('package')}/firewall/policy/{args.get('policy')}")
        return f"Deleted Policy {args.get('policy')}"


    def move_policy_command(client, args):
        client.fortimanager_api_call("move", f"/pm/config/{get_global_or_adom(client, args)}"
                                             f"/pkg/{args.get('package')}/firewall/policy/{args.get('policy')}",
                                     other_params=setup_request_data(args, ['adom', 'package', 'policy']))

        return f"Moved policy with ID {args.get('policy')} {args.get('option')} {args.get('target')} " \
               f"in Policy Package: {args.get('package')}"


    def list_dynamic_interface_command(client, args):
        dynamic_interfaces = client.fortimanager_api_call("get", f"/pm/config/"
                                                                 f"{get_global_or_adom(client, args)}"
                                                                 f"/obj/dynamic/interface",
                                                          range_info=get_range_for_list_command(args))

        headers = ['name']

        return CommandResults(
            outputs_prefix='FortiManager.DynamicInterface',
            outputs_key_field='name',
            outputs=dynamic_interfaces,
            readable_output=tableToMarkdown(f"ADOM {client.adom} Dynamic Interfaces",
                                            dynamic_interfaces, removeNull=True, headerTransform=string_to_table_header,
                                            headers=headers),
            raw_response=dynamic_interfaces,
        )


    def install_policy_package_command(client, args):
        response = client.fortimanager_api_call('exec', "/securityconsole/install/package",
                                                json_data={
                                                    'adom_rev_comment': args.get('adom_rev_comment'),
                                                    'adom_rev_name': args.get('adom_rev_name'),
                                                    'dev_rev_comment': args.get('dev_rev_comment'),
                                                    'adom': get_global_or_adom(client, args).replace('adom/', ''),
                                                    'pkg': args.get('package'),
                                                    'scope': [{
                                                        "name": args.get('name'),
                                                        "vdom": args.get('vdom')
                                                    }]
                                                })
        formatted_response = {'id': response.get('task')}
        return CommandResults(
            outputs_prefix='FortiManager.Installation',
            outputs_key_field='id',
            outputs=formatted_response,
            readable_output=f"Initiated installation of the policy package: {args.get('package')} "
                            f"in ADOM: {get_global_or_adom(client, args)}\n"
                            f"On Device {args.get('name')} and VDOM {args.get('vdom')}.\nTask ID: {response.get('task')}."
                            f"\n\nYou can check the installation status by running:\n"
                            f"!fortimanager-firewall-policy-package-install-status task_id={response.get('task')}",
            raw_response=response
        )


    def install_policy_package_status_command(client, args):
        task_data = client.fortimanager_api_call('get', f"/task/task/{args.get('task_id')}")

        headers = ['id', 'title', 'adom', 'percent', 'state', 'line']

        return CommandResults(
            outputs_prefix='FortiManager.Installation',
            outputs_key_field='id',
            outputs=task_data,
            readable_output=tableToMarkdown(f"Installation Task {args.get('task_id')} Status",
                                            task_data, removeNull=True, headerTransform=string_to_table_header,
                                            headers=headers),
            raw_response=task_data
        )


    ''' MAIN FUNCTION '''


    def main() -> None:
        """main function, parses params and runs command functions

        :return:
        :rtype:
        """

        creds = demisto.params().get('credentials')
        base_url = demisto.params().get('url')
        adom = demisto.params().get('adom')
        verify_certificate = not demisto.params().get('insecure', False)
        proxy = demisto.params().get('proxy', False)

        demisto.debug(f'Command being called is {demisto.command()}')
        try:
            client = Client(
                url=base_url,
                credentials=creds,
                verify=verify_certificate,
                proxy=proxy,
                adom=adom
            )

            if demisto.command() == 'test-module':
                try:
                    list_adom_devices_command(client, {})
                except DemistoException as e:
                    if 'No permission for the resource' in str(e):
                        raise DemistoException("Unable to connect to the FortiManager Server - please check the "
                                               "entered credentials and ADOM.")

                    if 'Invalid url' in str(e):
                        raise DemistoException("Unable to connect to the default ADOM - please check the "
                                               "entered credentials and ADOM.")

                    else:
                        raise

                return_results("ok")

            elif demisto.command() == 'fortimanager-devices-list':
                return_results(list_adom_devices_command(client, demisto.args()))

            elif demisto.command() == 'fortimanager-device-groups-list':
                return_results(list_adom_devices_groups_command(client, demisto.args()))

            elif demisto.command() == 'fortimanager-address-list':
                return_results(list_firewall_addresses_command(client, demisto.args()))

            elif demisto.command() == 'fortimanager-address-create':
                return_results(create_address_command(client, demisto.args()))

            elif demisto.command() == 'fortimanager-address-update':
                return_results(update_address_command(client, demisto.args()))

            elif demisto.command() == 'fortimanager-address-delete':
                return_results(delete_address_command(client, demisto.args()))

            elif demisto.command() == 'fortimanager-address-group-list':
                return_results(list_address_groups_command(client, demisto.args()))

            elif demisto.command() == 'fortimanager-address-group-create':
                return_results(create_address_group_command(client, demisto.args()))

            elif demisto.command() == 'fortimanager-address-group-update':
                return_results(update_address_group_command(client, demisto.args()))

            elif demisto.command() == 'fortimanager-address-group-delete':
                return_results(delete_address_group_command(client, demisto.args()))

            elif demisto.command() == 'fortimanager-service-categories-list':
                return_results(list_service_categories_command(client, demisto.args()))

            elif demisto.command() == 'fortimanager-service-group-list':
                return_results(list_service_groups_command(client, demisto.args()))

            elif demisto.command() == 'fortimanager-service-group-create':
                return_results(create_service_group_command(client, demisto.args()))

            elif demisto.command() == 'fortimanager-service-group-update':
                return_results(update_service_group_command(client, demisto.args()))

            elif demisto.command() == 'fortimanager-service-group-delete':
                return_results(delete_service_group_command(client, demisto.args()))

            elif demisto.command() == 'fortimanager-custom-service-list':
                return_results(list_custom_service_command(client, demisto.args()))

            elif demisto.command() == 'fortimanager-custom-service-create':
                return_results(create_custom_service_command(client, demisto.args()))

            elif demisto.command() == 'fortimanager-custom-service-update':
                return_results(update_custom_service_command(client, demisto.args()))

            elif demisto.command() == 'fortimanager-custom-service-delete':
                return_results(delete_custom_service_command(client, demisto.args()))

            elif demisto.command() == 'fortimanager-firewall-policy-package-list':
                return_results(list_policy_packages_command(client, demisto.args()))

            elif demisto.command() == 'fortimanager-firewall-policy-package-create':
                return_results(create_policy_package_command(client, demisto.args()))

            elif demisto.command() == 'fortimanager-firewall-policy-package-update':
                return_results(update_policy_package_command(client, demisto.args()))

            elif demisto.command() == 'fortimanager-firewall-policy-package-delete':
                return_results(delete_policy_package_command(client, demisto.args()))

            elif demisto.command() == 'fortimanager-firewall-policy-list':
                return_results(list_policies_command(client, demisto.args()))

            elif demisto.command() == 'fortimanager-firewall-policy-create':
                return_results(create_policy_command(client, demisto.args()))

            elif demisto.command() == 'fortimanager-firewall-policy-update':
                return_results(update_policy_command(client, demisto.args()))

            elif demisto.command() == 'fortimanager-firewall-policy-delete':
                return_results(delete_policy_command(client, demisto.args()))

            elif demisto.command() == 'fortimanager-firewall-policy-move':
                return_results(move_policy_command(client, demisto.args()))

            elif demisto.command() == 'fortimanager-dynamic-interface-list':
                return_results(list_dynamic_interface_command(client, demisto.args()))

            elif demisto.command() == 'fortimanager-firewall-policy-package-install':
                return_results(install_policy_package_command(client, demisto.args()))

            elif demisto.command() == 'fortimanager-firewall-policy-package-install-status':
                return_results(install_policy_package_status_command(client, demisto.args()))

        # Log exceptions and return errors
        except Exception:
            return_error(f'Failed to execute {demisto.command()} command.')


    ''' ENTRY POINT '''

    if __name__ in ('__main__', '__builtin__', 'builtins'):
        main()

    register_module_line('FortiManager', 'end', __line__())
  subtype: python3
  type: python
system: true
